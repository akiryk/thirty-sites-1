{"version":3,"sources":["js/main.js"],"names":["pixiApp","displacementFilter","displacementImage","this","createPixiApp","init","loadPixiImage","PIXI","Application","width","height","backgroundColor","transparent","document","getElementById","appendChild","view","loader","pixiImage","load","setup","bind","resources","body","classList","add","console","removeLoader","app","stage","centerStageX","renderer","screen","centerStageY","mainPic","Sprite","texture","clouds","anchor","set","position","addDisplacementFilter","addChild","startPixiLoop","initScrollMagic","sprite","gameloop","delta","img","filters","DisplacementFilter","scale","x","y","makeHeaderScenes","makeEndScene","makeParagraphScenes","makeDisplacementAnimationScene","makeController","ScrollMagic","Controller","outro","querySelector","topTween","TweenLite","bottomTween","duration","window","innerHeight","from","top","rotation","triggerHook","Scene","toggle","controller","setTween","triggerElement","bottom","addTo","intro","paras","Array","querySelectorAll","to","scene","para","tween","scaleObj","distortionTween","offset","transform","TweenMax","clone"],"mappings":"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","file":"main.js","sourcesContent":["// TODO: use promises or some other better way to handle how initScrollMagic\n// is called. Right now, it's done in the Pixi setup method.\n(function() {\n\n  // Constants\n  const FILTERX     = 250,\n        FILTERY     = 140,\n        APPWIDTH    = 1200,\n        APPHEIGHT   = 1200,\n        APPBGCOLOR  = 0x000000;\n\n  const removeLoader = () => {\n    document.body.classList.add('ready');\n    console.log('no, right')\n  }\n\n  const App = {\n    pixiApp: null,\n    displacementFilter: null,\n    pixiImage: 'images/skater-1024.jpg',\n    displacementImage: 'images/clouds-1024.jpg',\n\n    init() {\n      this.createPixiApp();\n      this.loadPixiImage();\n    },\n\n    createPixiApp() {\n      this.pixiApp = new PIXI.Application({\n        width: APPWIDTH,\n        height: APPHEIGHT,\n        backgroundColor : APPBGCOLOR,\n        transparent: false,\n        antialias: false,\n      });\n      document.getElementById('pixiContainer').appendChild(this.pixiApp.view);\n    },\n\n    /**\n     * Load images for Pixi animations\n     * Keep a reference to this.pixiImage for later manipulations\n     */\n    loadPixiImage() {\n      PIXI.loader\n        .add('mainPic', this.pixiImage)\n        .add('clouds', this.displacementImage)\n        .load(this.setup.bind(this));\n    },\n\n    /**\n     * Setup is a callback function from PIXI's load method and\n     * it fires once images are ready to handle.\n     */\n    setup(loader, resources){\n      // Fade out the loader animation\n      removeLoader();\n\n      // Cache some references\n      const app = this.pixiApp;\n      const stage = this.pixiApp.stage;\n\n      // Cache stage details\n      const centerStageX = app.renderer.screen.width/2;\n      const centerStageY = app.renderer.screen.height/2;\n\n      // Make sprites from images\n      const mainPic = new PIXI.Sprite(resources.mainPic.texture);\n      const clouds = new PIXI.Sprite(resources.clouds.texture);\n\n      // Center sprite origins\n      mainPic.anchor.set(.5);\n      clouds.anchor.set(.5);\n      mainPic.position.set(centerStageX, centerStageY);\n      clouds.position.set(centerStageX, centerStageY);\n\n      // Make Filters\n      this.addDisplacementFilter(clouds);\n\n      // Add Images\n      stage.addChild(mainPic);\n      stage.addChild(clouds);\n\n      this.startPixiLoop(clouds);\n      this.initScrollMagic();\n    },\n\n    startPixiLoop(sprite) {\n      // Displacement map animation loop\n      this.pixiApp.ticker.add(delta => gameloop(delta));\n\n      function gameloop(delta){\n        sprite.rotation -= .002;\n      }\n    },\n\n    addDisplacementFilter(img) {\n      this.displacementFilter = new PIXI.filters.DisplacementFilter(img);\n      this.displacementFilter.scale.x = FILTERX;\n      this.displacementFilter.scale.y = FILTERY;\n      this.pixiApp.stage.filters = [this.displacementFilter];\n    },\n\n    initScrollMagic() {\n      this.makeController();\n      this.makeHeaderScenes();\n      this.makeEndScene();\n      this.makeParagraphScenes();\n      this.makeDisplacementAnimationScene();\n    },\n\n    makeController() {\n      this.controller = new ScrollMagic.Controller();\n    },\n\n    makeEndScene() {\n      const controller = this.controller;\n      const top = document.getElementById('introHeadClone').querySelector('.end-headline--top');\n      const bottom = document.getElementById('introHeadClone').querySelector('.end-headline--bottom');\n      const outro = document.querySelector('.intro--clone');\n      const topTween = TweenLite.from(top, 1, {x: -300});\n      const bottomTween = TweenLite.from(bottom, 1, {x: 60});\n      const duration = .6 * window.innerHeight;\n\n      TweenLite.set('#introHeadClone', {rotation: -20});\n\n      new ScrollMagic.Scene({\n        duration: duration,\n        triggerElement: outro,\n        triggerHook: .4,\n      })\n        .setTween('#introHeadClone', 1, {rotation: 0})\n        .on('end', (e) => {\n          outro.classList.toggle('active');\n        })\n        .addTo(controller);\n\n      new ScrollMagic.Scene({\n        duration: duration,\n        triggerElement: outro,\n        triggerHook: .4,\n      })\n        .setTween(topTween)\n        .addTo(controller);\n\n     new ScrollMagic.Scene({\n        duration: duration,\n        triggerElement: outro,\n        triggerHook: .4,\n      })\n        .setTween(bottomTween)\n        .addTo(controller);\n    },\n\n    makeHeaderScenes() {\n      const intro = document.getElementById('introHead');\n      const top = document.querySelector('.headline--top');\n      const bottom = document.querySelector('.headline--bottom');\n      const duration = .85 * window.innerHeight;\n      const controller = this.controller;\n\n      new ScrollMagic.Scene({ duration: duration })\n        .setTween(intro, 1, {rotation: 20})\n        .addTo(controller);\n\n      new ScrollMagic.Scene({ duration: duration })\n        .setTween(top, 1, {x: 200 })\n        .addTo(controller);\n\n      new ScrollMagic.Scene({ duration: duration })\n        .setTween(bottom, 1, {x: -200 })\n        .addTo(controller);\n    },\n\n    makeParagraphScenes() {\n      const paras = Array.from(document.querySelectorAll('.para'));\n      const controller = this.controller;\n\n      paras.forEach(para => {\n        const tween = TweenLite.to(para, 1, {transform: 'matrix(.98, -.075, .075, .98, 0, 0)'});\n        const scene = new ScrollMagic.Scene({\n          duration: '150%',\n          triggerHook: 'onEnter',\n          triggerElement: para,\n        })\n          .setTween(tween)\n          .addTo(controller);\n      })\n    },\n\n    makeDisplacementAnimationScene() {\n      const scaleObj = this.displacementFilter.scale;\n      const distortionTween = TweenMax.to(scaleObj, .85, {x: 0, y: 0});\n      const controller = this.controller;\n      const clone = document.getElementById('introHeadClone');\n\n      new ScrollMagic.Scene({\n        offset: 300,\n        duration: '100%',\n      })\n        .setTween(distortionTween)\n        .addTo(controller);\n\n      new ScrollMagic.Scene({\n        triggerElement: clone,\n        triggerHook: 'onEnter',\n        duration: '100%',\n      })\n        .setTween(TweenLite.to(scaleObj, 1, {x: FILTERX, y: FILTERY}))\n        .addTo(controller);\n    },\n\n  }\n\n  App.init();\n\n})();\n"]}